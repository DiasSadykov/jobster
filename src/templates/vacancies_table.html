
<div class="flex flex-row justify-center">
    <div class="flex flex-col mx-6">
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="intern">Intern</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="junior">Junior</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="middle">Middle</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="senior">Senior</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="lead">Lead</button>
    </div>
    <div class="flex flex-col ml-6">
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="frontend">Frontend</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="backend">Backend</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="fullstack">Fullstack</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="qa">QA</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="ios">iOS</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="android">Android</button>
    </div>
    <div class="flex flex-col">
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="product">Product</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="data">Data</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="design">Design</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="analyst">Analyst</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="sysadmin">SysAdmin</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="devops">DevOps</button>
    </div>
    <div class="flex flex-col ml-6">
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter=".net">.Net</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="golang">Go</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="python">Python</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="java">Java</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="c++">C++</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="c#">C#</button>
    </div>
    <div class="flex flex-col">
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="php">php</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="javascript">js</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="react">react</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="node">node</button>
        <button class="filter-button-{{id}} badge badge-lg badge-primary badge-outline m-1" data-filter="sql">sql</button>
    </div>
</div>

<table id="{{id}}">
<thead>
    <tr>
    <th
        class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider"
    >
        Позиция
    </th>
    <th
        class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider"
    >
        Компенсация
    </th>
    <th
        class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider"
    >
        Компания
    </th>
    <th
        class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider"
    >
        Город
    </th>
    <th
        class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider"
    >
        Теги
    </th>
    </tr>
</thead>
<tbody>
</tbody>
</table>
<script>
    table{{id}} = new DataTable('#{{id}}', {
        columns: [
            { title: 'Позиция' },
            { title: 'Компания' },
            { title: 'Компенсация' },
            { title: 'Город' },
            { title: 'Теги' }
        ],
        order: [],
        data: [
            {% for vacancy in vacancies %}
                [
                    "{{vacancy.title}}",
                    "{{vacancy.company}}",
                    "{{vacancy.salary or 'Зарплата не указана'}}",
                    "{{vacancy.city}}",
                    "{{vacancy.tags}}",
                    "{{vacancy.url}}",
                ],
            {% endfor %}
        ],
        initComplete: function(settings, json) {
          $('.dataTables_filter').removeClass('dataTables_filter').addClass('font-semibold rounded-md');
          $('input[aria-controls="{{id}}"]').addClass('input input-bordered w-full max-w-lg m-6 shadow').attr('id', 'tableSearch{{id}}');
          $('.dataTables_paginate').addClass('p-6 font-bold');
          $('.dataTables_length').remove();
          $('.dataTables_info').addClass('p-6 font-bold');
        },
        columnDefs: [
              {
                  targets: 0,
                  render:  function ( data, type, row ) {
                      return `<a href=`+row[5]+` target='_blank'>
                              <div class="flex text-xl h-20 hover:scale-105 transition">
                                <p class="my-auto max-h-full overflow-hidden text-gray-900 font-bold">`
                                  + data + `</p>
                        </div></a>`;
                  },
                  className: 'h-20 border-b border-gray-200 bg-white text-sm'
              },
              {
                  targets: [],
                  render:  function ( data, type, row ) {
                      return `<p class="text-gray-900 whitespace-no-wrap">`+data+`</p>`
                      
                  },
                  className: 'h-20 border-b border-gray-200 bg-white text-sm'
              },
              {
                  targets: [1,2],
                  render:  function ( data, type, row ) {
                      return `<div class="flex">
                            <div class="ml-3">
                            <p class="text-gray-900 font-bold whitespace-no-wrap">`
                                + data +
                            `</p>
                            </div>
                        </div>`;
                  },
                  className: 'h-20 border-b border-gray-200 bg-white text-sm'
              },
              {
                  targets: [3],
                  render:  function ( data, type, row ) {
                      return `<span
                            class="relative inline-block px-3 py-1 font-semibold text-green-900 leading-tight"
                        >
                            <span
                            aria-hidden
                            class="absolute inset-0 bg-green-200 opacity-50 rounded-full"
                            ></span>
                            <span class="relative">`+data +`</span>
                        </span>`;
                  },
                  className: 'h-20 border-b border-gray-200 bg-white text-sm'
              },
              {
                    target: 4,
                    visible: false
              }
        ]
    });
    var activeFilters{{id}} = {};

    $('.filter-button-{{id}}').click(function() {
        var filter = $(this).data('filter');
        if (activeFilters{{id}}[filter]) {
            delete activeFilters{{id}}[filter];
            $(this).addClass('badge-outline');
        } else {
            activeFilters{{id}}[filter] = true;
            $(this).removeClass('badge-outline');
        }
        let regex = '';
        for (var filter in activeFilters{{id}}) {
            regex += '(?=.*'+filter+')';
        }
        table{{id}}.columns(4).search(regex, true, false, true).draw();
    });

    var typed{{id}} = new Typed('#tableSearch{{id}}', {
        strings: ['Junior', 'Javascript', 'Алматы'],
        typeSpeed: 100,
        backSpeed: 50,
        attr: 'placeholder',
        loop: true
    });
  </script>